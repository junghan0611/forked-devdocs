<header><h1>MutationObserver.observe()</h1></header><div class="section-content">
<p><a href="../mutationobserver"><code>MutationObserver</code></a>의 <code>observe()</code> 메서드는 지정한 옵션을 만족하는 DOM 변경 알림을 수신한 경우 <code>MutationObserver</code>의 콜백을 호출하도록 설정합니다.</p> <p>설정에 따라서 <code>MutationObserver</code>는 DOM 트리의 단일 <a href="../node"><code>Node</code></a>를 주시하거나, 노드와 그 아래 노드를 모두 주시할 수 있습니다.</p> <p><code>MutationObserver</code>의 콜백이 더 이상 호출되지 않도록 하려면 <a href="disconnect"><code>MutationObserver.disconnect()</code></a>를 사용하세요.</p>
</div>
<h2 id="구문">구문</h2>
<div class="section-content"><div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="lgZVTQZsKx9FRwTRxMw8eO6Wf/dPc95AFutBnSY/LdA=" data-language="js"><span class="token function">observe</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
</pre>
</div></div>
<h3 id="매개변수">매개변수</h3>
<div class="section-content"><dl> <dt id="target"><code>target</code></dt> <dd> <p>DOM 트리 내에서 변경을 감지할 노드 또는 하위 트리 루트로서의 <a href="../node"><code>Node</code></a>입니다. (<a href="../element"><code>Element</code></a> 포함)</p> </dd> <dt id="options"><code>options</code></dt> <dd> <p> 주시하고자 하는 DOM 변경을 나타내는 객체입니다. 이 옵션을 만족하는 DOM 변경들만 <code>MutationObserver</code>의 콜백으로 전달됩니다. 적어도 <code>childList</code>, <code>attributes</code>, <code>characterData</code> 중 하나는 <code>true</code>여야 하며 세 속성 모두 <code>false</code>면 <code>TypeError</code>가 발생합니다. </p> <p>사용 가능한 옵션은 다음과 같습니다.</p> <dl> <dt id="subtree">
<code>subtree</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p><code>true</code>로 지정하면 <code>target</code>이 루트인 하위 트리 전체를 주시합니다. 다른 옵션들도 <code>target</code> 노드 하나가 아니라 이 하위 트리에 속한 모든 노드에 대해 적용됩니다. 기본 값은 <code>false</code>입니다.</p> </dd> <dt id="childlist">
<code>childList</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p><code>true</code>로 지정하면 대상 노드에 자식이 추가되거나 기존 자식이 제거되는 것을 감지합니다. <code>subtree</code>가 <code>true</code>면 자손들의 자식 변경도 감지합니다. 기본 값은 <code>false</code>입니다.</p> </dd> <dt id="attributes">
<code>attributes</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p><code>true</code>로 지정하면 주시 중인 노드 또는 노드들의 특성 변경을 감지합니다. 기본 값은 <code>attributeFilter</code> 또는 <code>attributeOldValue</code>가 지정된 경우 <code>true</code>, 아니면 <code>false</code>입니다.</p> </dd> <dt id="attributefilter">
<code>attributeFilter</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>변경을 감지할 특성 이름의 배열입니다. 이 속성을 지정하지 않으면 모든 특성의 변경이 알림을 생성합니다.</p> </dd> <dt id="attributeoldvalue">
<code>attributeOldValue</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p><code>true</code>로 지정하면 노드의 특성 변경을 감지했을 때 해당 특성이 바뀌기 전 값을 기록합니다. 기본 값은 <code>false</code>입니다.</p> </dd> <dt id="characterdata">
<code>characterData</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p><code>true</code>로 지정하면 대상 노드 내의 텍스트가 바뀌는 것을 감지합니다. <code>subtree</code>가 <code>true</code>면 자손들의 텍스트 변경도 감지합니다. 기본 값은 <code>characterDataOldValue</code>가 지정된 경우 <code>true</code>, 아니면 <code>false</code>입니다.</p> </dd> <dt id="characterdataoldvalue">
<code>characterDataOldValue</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p><code>true</code>로 지정하면 노드의 텍스트 변경을 감지했을 때 바뀌기 전의 텍스트를 기록합니다. 기본 값은 <code>false</code>입니다.</p> </dd> </dl> </dd> </dl></div>
<h3 id="반환_값">반환 값</h3>
<div class="section-content"><p>없음 (<a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/undefined"><code>undefined</code></a>).</p></div>
<h3 id="예외">예외</h3>
<div class="section-content"><dl> <dt id="typeerror"><a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/TypeError"><code>TypeError</code></a></dt> <dd> <p>다음 상황에서 발생합니다.</p> <ul> <li> 지정한 <code>options</code>로는 감지할 수 있는 변경이 없을 때 (<code>childList</code>, <code>attributes</code>, <code>characterData</code>가 모두 <code>false</code>일 때) </li> <li>
<code>options</code>의 <code>attributes</code>가 <code>false</code>(특성 변경을 감지하지 않음)인데 <code>attributeOldValue</code>가 <code>true</code>거나 <code>attributeFilter</code>를 지정한 경우</li> <li>
<code>options</code>의 <code>characterData</code>가 <code>false</code>(텍스트 변경을 감지하지 않음)인데 <code>characterDataOldValue</code>가 <code>true</code>인 경우</li> </ul> </dd> </dl></div>
<h2 id="사용_일람">사용 일람</h2>

<h3 id="mutationobserver_재활용">MutationObserver 재활용</h3>
<div class="section-content">
<p><code>MutationObserver</code> 인스턴스 하나의 <code>observe()</code>를 여러 번 호출하면 DOM 트리 곳곳의 서로 다른 변경 유형을 하나의 감지기만으로 감지할 수 있습니다. 하지만 주의해야 할 점이 있습니다.</p> <ul> <li>어떤 <code>MutationObserver</code> 인스턴스가 주시 중인 노드를 같은 인스턴스로 다시 주시할 경우, 이 노드에 대한 해당 인스턴스의 기존 주시는 자동으로 해제되고 새로 시작합니다.</li> <li>
<code>MutationObserver</code> 인스턴스가 그 노드를 주시하고 있지 않았다면 다른 주시들은 영향을 받지 않습니다.</li> </ul>
</div>
<h3 id="트리_분리_후에도_주시는_지속됨">트리 분리 후에도 주시는 지속됨</h3>
<div class="section-content">
<p><code>MutationObserver</code>는 노드들의 연결이 끊어져도 주시가 끊기지 않도록 설계됐습니다. 그래서 주시 중인 하위 트리의 일부를 분리해 DOM의 다른 곳으로 옮기는 동시에 그 노드들의 특성을 변경하는 경우에도 특성 변경 알림까지 수신할 수 있습니다.</p> <p>다시 말해, 주시 중인 하위 트리에서 노드가 분리된다는 알림이 콜백까지 전달되기 전까지는 분리된 하위 트리와 해당 노드의 변경 사항에 대한 알림을 계속 받습니다.</p> <p>이와 같은 주시 동작으로 인해, 각각의 변경을 나타내는 <a href="../mutationrecord"><code>MutationRecord</code></a> 객체들을 보관해둔다면 이론적으로는 트리의 분리를 "실행 취소" 하여 DOM 상태를 되감는 게 가능합니다.</p>
</div>
<h2 id="예제">예제</h2>

<h3 id="기본_예제">기본 예제</h3>
<div class="section-content">
<p>이 예제에서는 <a href="../mutationobserver"><code>MutationObserver</code></a> 인스턴스를 생성한 후 대상 노드와 옵션 객체를 사용해 <code>observe()</code> 메서드를 호출하는 방법을 보입니다.</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="CMqMbOk2Geh/FeUGNg4E4ruqtN4M87TXVOno4HudABU=" data-language="js"><span class="token comment">// 주시할 요소 식별</span>
<span class="token keyword">const</span> elementToObserve <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#targetElementId"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 콜백 함수를 지정한 새로운 MutationObserver 인스턴스 생성</span>
<span class="token comment">// observer 변수에 할당</span>
<span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"callback that runs when observer is triggered"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// </span>
<span class="token comment">// 위 MutationObserver 인스턴스의 observe() 메서드를 호출</span>
<span class="token comment">// 주시할 요소와 옵션 객체 전달</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>elementToObserve<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">subtree</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">childList</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div>
<h3 id="attributefilter_사용하기">
<code>attributeFilter</code> 사용하기</h3>
<div class="section-content">
<p>이 예제는 채팅방을 가정하고, 사용자들의 이름을 포함한 하위 트리를 주시하여 <code>status</code>와 <code>username</code> 특성의 변경를 감지합니다. 그 후에는 사용자가 닉네임을 변경한 경우를 반영하거나, 자리비움 상태를 강조하는 등의 기능을 추가할 수 있을 것입니다.</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="6l6rnfVoLL2PLZYpso9vEzzWptPlWIzPx5A0votO/fA=" data-language="js"><span class="token keyword">function</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token parameter">mutationList</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  mutationList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">mutation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>mutation<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">"attributes"</span><span class="token operator">:</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>mutation<span class="token punctuation">.</span>attributeName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">case</span> <span class="token string">"status"</span><span class="token operator">:</span>
            <span class="token function">userStatusChanged</span><span class="token punctuation">(</span>mutation<span class="token punctuation">.</span>target<span class="token punctuation">.</span>username<span class="token punctuation">,</span> mutation<span class="token punctuation">.</span>target<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token keyword">case</span> <span class="token string">"username"</span><span class="token operator">:</span>
            <span class="token function">usernameChanged</span><span class="token punctuation">(</span>mutation<span class="token punctuation">.</span>oldValue<span class="token punctuation">,</span> mutation<span class="token punctuation">.</span>target<span class="token punctuation">.</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> userListElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#userlist"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>userListElement<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">attributeFilter</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"status"</span><span class="token punctuation">,</span> <span class="token string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">attributeOldValue</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">subtree</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div>
<h2 id="명세서">명세서</h2>
<div class="_table"><table class="standard-table">
<thead><tr><th scope="col">Specification</th></tr></thead>
<tbody><tr><td><a href="#">DOM Standard <br><small># ref-for-dom-mutationobserver-observe②</small></a></td></tr></tbody>
</table></div>
<h2 id="브라우저_호환성">브라우저 호환성</h2>
<p>BCD tables only load in the browser<noscript> with JavaScript enabled. Enable JavaScript to view data.</noscript></p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/ko/docs/Web/API/MutationObserver/observe" class="_attribution-link">https://developer.mozilla.org/ko/docs/Web/API/MutationObserver/observe</a>
  </p>
</div>

<header><h1>Atomics</h1></header><div class="section-content"><p> <code>Atomics</code> 객체는 아토믹 연산(Atomic operation, 원자적 연산)을 정적 메서드로 제공합니다. <a href="sharedarraybuffer"><code>SharedArrayBuffer</code></a> 와 <a href="arraybuffer"><code>ArrayBuffer</code></a> 객체와 함께 사용됩니다. </p></div>
<section aria-labelledby="설명"><h2 id="설명">설명</h2>
<div class="section-content"><p> 아토믹 연산은 <code>Atomic</code> 모듈에 설치됩니다. 다른 전역 객체와 달리 <code>Atomics</code>는 생성자가 아니기 때문에, <a href="../operators/new"><code>new</code> 연산자</a>와 함께 사용하거나 <code>Atomics</code> 객체를 함수로 호출할 수 없습니다. <a href="math"><code>Math</code></a> 객체처럼 <code>Atomics</code>의 모든 속성과 메서드는 정적입니다. </p></div></section><section aria-labelledby="아토믹_연산"><h3 id="아토믹_연산">아토믹 연산</h3>
<div class="section-content"><p> 메모리가 공유되면 여러 스레드가 메모리에서 동일한 데이터를 읽고 쓸 수 있습니다. 아토믹 연산은 예측 가능한 값을 쓰고 읽고, 다음 연산이 시작되기 전에 연산을 완료하여 연산이 중단되지 않도록 합니다. </p></div></section><section aria-labelledby="wait와_notify"><h3 id="wait와_notify">Wait와 notify</h3>
<div class="section-content"><p> <code>wait()</code>와 <code>notify()</code> 메서드는 Linux 퓨텍스(futex)("빠른 사용자 공간 뮤텍스(mutex)")에서 모델링되어 특정 조건이 참이 될 때까지 기다리는 방법을 제공하며 일반적으로 차단 구문으로 사용됩니다. </p></div></section><section aria-labelledby="정적_속성"><h2 id="정적_속성">정적 속성</h2>
<div class="section-content"><dl> <dt id="atomicstostringtag"><code>Atomics[@@toStringTag]</code></dt> <dd> <p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/toStringTag" class="only-in-en-us"><code>@@toStringTag</code> <small>(en-US)</small></a> 속성의 초기 값은 <code>"Atomics"</code> 문자열입니다. 이 속성은 <a href="object/tostring"><code>Object.prototype.toString()</code></a>에서 사용됩니다.</p> </dd> </dl></div></section><section aria-labelledby="정적_메서드"><h2 id="정적_메서드">정적 메서드</h2>
<div class="section-content"><dl> <dt id="atomics.add"><a href="atomics/add"><code>Atomics.add()</code></a></dt> <dd> <p>배열의 특정 인덱스에 있던 값에 전달된 값을 추가합니다. 해당 인덱스의 이전 값을 반환합니다.</p> </dd> <dt id="atomics.and"><a href="atomics/and"><code>Atomics.and()</code></a></dt> <dd> <p>전달된 값과 배열의 지정된 인덱스에 있는 값으로 AND 연산을 수행합니다. 해당 인덱스의 이전 값을 반환합니다.</p> </dd> <dt id="atomics.compareexchange"><a href="atomics/compareexchange"><code>Atomics.compareExchange()</code></a></dt> <dd> <p>배열의 지정된 인덱스 값과 같으면 그곳에 값을 저장합니다. 이전 값을 반환합니다.</p> </dd> <dt id="atomics.exchange"><a href="atomics/exchange"><code>Atomics.exchange()</code></a></dt> <dd> <p>배열의 지정된 위치에 전달받은 값을 저장합니다. 이전 값을 반환합니다.</p> </dd> <dt id="atomics.islockfreesize"><a href="atomics/islockfree"><code>Atomics.isLockFree(size)</code></a></dt> <dd> <p>잠금 또는 atomic 연산을 사용할지 여부를 결정하는 데 사용할 수 있는 최적화 기본 요소입니다. 주어진 요소 크기의 배열에 대한 atomic 연산이 하드웨어 atomic 연산(잠금과 반대)을 사용하여 구현되는 경우 <code>true</code>를 반환합니다. 전문가만 사용합니다.</p> </dd> <dt id="atomics.load"><a href="atomics/load"><code>Atomics.load()</code></a></dt> <dd> <p>배열의 지정된 위치에 있는 값을 반환합니다.</p> </dd> <dt id="atomics.notify"><a href="atomics/notify"><code>Atomics.notify()</code></a></dt> <dd> <p>배열의 지정된 인덱스에서 대기 중인 에이전트에 알립니다. 알림을 받은 에이전트 수를 반환합니다.</p> </dd> <dt id="atomics.or"><a href="atomics/or"><code>Atomics.or()</code></a></dt> <dd> <p>전달된 값과 배열의 지정된 인덱스에 있는 값으로 OR 연산을 수행합니다. 해당 인덱스의 이전 값을 반환합니다.</p> </dd> <dt id="atomics.store"><a href="atomics/store"><code>Atomics.store()</code></a></dt> <dd> <p>배열의 지정된 인덱스에 값을 저장합니다. 값을 반환합니다.</p> </dd> <dt id="atomics.sub"><a href="atomics/sub"><code>Atomics.sub()</code></a></dt> <dd> <p>배열의 지정된 인덱스에서 값을 뺍니다. 해당 인덱스의 이전 값을 반환합니다.</p> </dd> <dt id="atomics.wait"><a href="atomics/wait"><code>Atomics.wait()</code></a></dt> <dd> <p>배열의 지정된 인덱스가 여전히 값을 포함하고있고 대기 중이거나 시간 초과됐는지 확인합니다. <code>"ok"</code>, <code>"not-equal"</code> 또는 <code>"timed-out"</code>을 반환합니다. 호출 에이전트에서 대기가 허용되지 않으면 예외가 발생합니다. (대부분의 브라우저는 브라우저의 메인 스레드에서 <code>wait()</code>을 허용하지 않습니다.)</p> </dd> <dt id="atomics.waitasync"><a href="atomics/waitasync"><code>Atomics.waitAsync()</code></a></dt> <dd> <p>공유 메모리 위치에서 비동기식으로(즉, <code>Atomics.wait</code>와 다르게 차단 없이) 대기하고 <a href="promise"><code>프로미스</code></a>를 반환합니다.</p> </dd> <dt id="atomics.xor"><a href="atomics/xor"><code>Atomics.xor()</code></a></dt> <dd> <p>제공된 값을 사용하여 배열의 지정된 인덱스에 있는 값에 대해 XOR 연산을 수행합니다. 해당 인덱스의 이전 값을 반환합니다.</p> </dd> </dl></div></section><section aria-labelledby="예제"><h2 id="예제">예제</h2>
</section><section aria-labelledby="atomic_사용하기"><h3 id="atomic_사용하기">Atomic 사용하기</h3>
<div class="section-content"><div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="z4xw+ZHZz6e5zZCcUTnhuVRPrZRFJQBjntv/Fm0cdZo=" data-language="js"><span class="token keyword">const</span> sab <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SharedArrayBuffer</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ta <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>sab<span class="token punctuation">)</span><span class="token punctuation">;</span>

ta<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
ta<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>

Atomics<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>
Atomics<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 17</span>

Atomics<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 17</span>
Atomics<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>

Atomics<span class="token punctuation">.</span><span class="token function">compareExchange</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
Atomics<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>

Atomics<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
Atomics<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 12</span>

Atomics<span class="token punctuation">.</span><span class="token function">isLockFree</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
Atomics<span class="token punctuation">.</span><span class="token function">isLockFree</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
Atomics<span class="token punctuation">.</span><span class="token function">isLockFree</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
Atomics<span class="token punctuation">.</span><span class="token function">isLockFree</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

Atomics<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 12</span>
Atomics<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 13</span>

Atomics<span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 12</span>

Atomics<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 12</span>
Atomics<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10</span>

Atomics<span class="token punctuation">.</span><span class="token function">xor</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10</span>
Atomics<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>ta<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 11</span>
</pre>
</div></div></section><section aria-labelledby="waiting과_notifying"><h3 id="waiting과_notifying">Waiting과 notifying</h3>
<div class="section-content">
<p><code>Int32Array</code>를 공유한다고 했을 때</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="oKIjep0hXMO6zfAKVMKOEySwh+mGkkqcgq96HSdwiGw=" data-language="js"><span class="token keyword">const</span> sab <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SharedArrayBuffer</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> int32 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Int32Array</span><span class="token punctuation">(</span>sab<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p> 읽기 스레드는 0이 될 것으로 예상되는 위치 0에서 sleep 상태이며 대기 중입니다. 이것이 사실인 한 계속되지 않습니다. 그러나 쓰기 스레드가 새 값을 저장하면 쓰기 스레드에서 이를 알리고 새 값을 반환합니다. (123) </p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="yPXZjAwb8Dbut3aX6XedjJclrSZ6lG8RuXKCy+DJ3Pc=" data-language="js">Atomics<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span>int32<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>int32<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 123</span>
</pre>
</div> <p>쓰기 스레드는 새 값을 저장하고 대기 중인 스레드가 작성되면 알립니다.</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="18P2HG9HcRIPYM3inHAWmTkZBy8rQENRZlBSYKYBNzE=" data-language="js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>int32<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0;</span>
Atomics<span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span>int32<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Atomics<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span>int32<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div></section><h2 id="명세서">명세서</h2>
<div class="_table"><table class="standard-table">
<thead><tr><th scope="col">Specification</th></tr></thead>
<tbody><tr><td><a href="https://tc39.es/ecma262/multipage/structured-data.html#sec-atomics-object">ECMAScript Language Specification <br><small># sec-atomics-object</small></a></td></tr></tbody>
</table></div>
<h2 id="브라우저_호환성">브라우저 호환성</h2>
<p>BCD tables only load in the browser<noscript> with JavaScript enabled. Enable JavaScript to view data.</noscript></p>
<section aria-labelledby="같이_보기"><h2 id="같이_보기">같이 보기</h2>
<div class="section-content"><ul> <li><a href="arraybuffer"><code>ArrayBuffer</code></a></li> <li><a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Typed_arrays">JavaScript 형식화 배열</a></li> <li><a href="https://developer.mozilla.org/ko/docs/Web/API/Web_Workers_API">웹 워커</a></li> <li>
<a href="https://github.com/lars-t-hansen/parlib-simple" target="_blank">parlib-simple</a> – 동기화 및 작업 배포 추상화를 제공하는 간단한 라이브러리입니다.</li> <li><a href="https://github.com/tc39/ecmascript_sharedmem/blob/master/TUTORIAL.md" target="_blank">Shared Memory – a brief tutorial</a></li> <li><a href="https://hacks.mozilla.org/2016/05/a-taste-of-javascripts-new-parallel-primitives/" target="_blank">A Taste of JavaScript’s New Parallel Primitives – Mozilla Hacks</a></li> </ul></div></section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Atomics" class="_attribution-link">https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Atomics</a>
  </p>
</div>
